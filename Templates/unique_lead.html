


<md-button flex href='#my_opportunities' class="md-raised md-primary">
	<md-icon class="material-icons">chevron_left</md-icon>
</md-button> 

<md-button flex class="md-raised md-primary" ng-click='addModal($event)'>
	<md-icon class="material-icons">add</md-icon>
</md-button> 

<md-button flex class="md-raised md-primary" ng-click='deleteLead($event)'>
	<md-icon class="material-icons">delete</md-icon>
</md-button> 

<md-button flex class="md-raised md-primary" ng-click='updateEmailDatabase()'>
	<md-icon class="material-icons">refresh</md-icon>
</md-button> 

<md-button hide-gt-sm flex ng-click='gotoEmail()' class="md-raised md-primary">
	<md-icon class="material-icons">email</md-icon>
</md-button> 



<md-content flex="auto" layout-gt-sm='row'> 

	<div flex="auto" layout='column'  style='min-height:1000px;max-width: 800px'> 


		<md-card flex='auto' layout='row'> 

			<md-card-title layout='column' layout-fill > 

				<md-card-title-text>

					<span class="md-headline"> {%verbatim%} {{ leadPage.name }} {%endverbatim%} </span>

					<span style='padding-top: 0px' class="md-subhead"> {%verbatim%} {{ leadPage.EmailAddress }} {%endverbatim%} </span>

					<span style='padding-top: 0px' class="md-subhead"> {%verbatim%} {{ leadPage.URL }} {%endverbatim%} </span>

					<span style='padding-top: 0px' class="md-subhead"> {%verbatim%} {{ leadPage.PhoneNumber }} {%endverbatim%} </span>

				</md-card-title-text>


			</md-card-title>




			<md-card-title flex='auto' layout='column' layout-fill layout-padding>  

				<md-card layout-align="end start">

					<md-card-title style='padding-top:0px;font-weight:600'> Contacts </md-card-title>

					<md-card-title style='padding-top:0px; min-width: 350px' >

						<table class='table'>


							<tr style='max-height: 40px!important; margin-bottom: 10px!important' layout='row' ng-repeat='contact in LeadsContacts'>

								<td> 

									<span > {%verbatim%} {{ contact.fname }} {{ contact.lname }} {%endverbatim%} </span> 

									<md-menu style='margin-bottom:0'>

						                <md-button aria-label='Open interactions menu' ng-click='openMenu($mdOpenMenu, $event)' class="md-icon-button" aria-label="More">
						                    <i class="material-icons">more_horiz</i>
						                </md-button>

						                <md-menu-content width='4'>


						                    <md-menu-item>
						                        <md-button ng-click='replyToButton(contact.email)'> 
						                            <i class='material-icons'>email</i>
						                            <span> Send email </span>
						                        </md-button>
						                    </md-menu-item>

						                    <md-menu-item>
						                        <md-button ng-click='viewContact(contact, $event)'> 
						                            <i class='material-icons'>person</i>
						                            <span> View</span>
						                        </md-button>
						                    </md-menu-item>
						                    

						                    <md-menu-divider></md-menu-divider>


						                    <md-menu-item >                        
						                        <md-button ng-click='deleteContact($event, contact)'> 
						                            <i class='material-icons'>delete</i>
						                            <span> Delete </span>
						                        </md-button>
						                    </md-menu-item>

						                </md-menu-content>

						            </md-menu>




								</td>

							</tr>
						
						</table>

					</md-card-title>

				</md-card>


				<md-card layout-align="end start">

					<md-card-title style='padding-top:0px;font-weight:600'> Opportunities </md-card-title>

					<md-card-title  flex style='padding-top:0px'>

					<table class='table'>

					<tr href='' layout='row' ng-repeat='opps in leadOpportunities'>

						<td> <span> {%verbatim%} {{ opps.qualify }} {%endverbatim%} </span> </td>
						<td> <span> {%verbatim%} {{ opps.size | currency: "Â£" :0 }} {%endverbatim%} </span> </td>
						<td> <span> {%verbatim%} {{ opps.FormattedDateClose }} {%endverbatim%} </span> </td>

					</tr>
					</table>

					</md-card-title>

				</md-card>

			</md-card-title>





		</md-card>




		<md-card flex='auto'> 



			<div flex='none' layout='column' >

			<md-card-content  style='margin-bottom:0px'>

				<span class="md-headline"> Activity Log </span>


			</md-card-content>

			<md-divider></md-divider>
					<md-content ng-repeat="a in leadActivity" style='background-color: white; padding-top:0;padding-bottom:0'>



						<md-list layout='row' style='padding-top: 0;padding-bottom: 0'>
						  <md-list-item class="md-3-line" style='padding-top: 0;padding-bottom: 0'>



						    <div style='padding:0px' class="md-list-item-text">
						      <br>
						      <p style='padding:0;font-size: 85%' >{%verbatim%} {{a.type}}: {{ a.name }}{%endverbatim%}</p>
						      
						      <p style='padding:0; font-size: 75%' ng-bind='a.FormattedDateTime'></p>

						      <h3 style='padding:0;font-size: 85%;white-space: pre' ng-bind-html='a.description'></h3>
						      </br>
						    </div>

						    </md-list-item>


						    <md-menu>
				                <md-button aria-label='Open interactions menu' ng-click='openMenu($mdOpenMenu, $event)' class="md-icon-button" aria-label="More" >
				                    <i class="material-icons">more_horiz</i>
				                </md-button>

				                <md-menu-content width='4'>


				                    <md-menu-item>
				                        <md-button ng-click='replyToButton(a.from_field)'> 
				                            <i class='material-icons'>reply</i>
				                            <span> Reply to</span>
				                        </md-button>
				                    </md-menu-item>
				                    

				                    <md-menu-divider></md-menu-divider>


				                    <md-menu-item >                        
				                        <md-button ng-click='deleteActivity($event, a)'> 
				                            <i class='material-icons'>delete</i>
				                            <span> Delete </span>
				                        </md-button>
				                    </md-menu-item>

				                </md-menu-content>

				            </md-menu>
						  
						</md-list>
						<md-divider></md-divider>


					</md-content>



			</div>

		</md-card>

	</div>


	
	<md-card flex="auto" style='max-height: 1000px'>

		<div layout-padding layout-margin layout-fill id="anchorEmail"> 

			<md-content style='background-color: white'> 

				<div flex='auto' layout='row'> 

					<md-input-container flex layout-align='center start' >
						<label>To:</label>
						<input ng-model='email_to'> 
					</md-input-container>

					<md-button ng-click='sendEmail()' layout-align="end center" aria-label='send email' class="md-icon-button" aria-label="send" >
						<i class="material-icons">send</i>
					</md-button>

				</div>
					



				<div layout='column'> 
					<md-input-container flex layout-align='center start' >
						<label>Subject</label>
						<input ng-model='email_subject'> 
					</md-input-container>


					<md-input-container flex layout-align='center start' >
						<label>Email</label>
						<textarea  rows="15" ng-model='email_body'></textarea >
					</md-input-container>				


				</div>

			</md-content>

		</div>

	</md-card>



</md-content>



<!-- Below is the addOppContact modal, hidden until prompted. Ideally this should be in 
    a separate template and file -->
    <div style="visibility: hidden">
      <div class="md-dialog-container" id="addModal" ng-coak>
            <md-dialog flex>

                <md-toolbar>
                  <div class="md-toolbar-tools">
                    <h2>Add </h2>
                    <span flex></span>
                    <md-button class="md-icon-button" ng-click="cancel()">
                      <md-icon md-svg-src="img/icons/ic_close_24px.svg" aria-label="Close dialog"></md-icon>
                    </md-button>
                  </div>
                </md-toolbar>



      <md-tabs md-dynamic-height md-border-bottom>
        <md-tab label="opportunity">


                <md-content flex layout-padding>

                    <form name="projectForm">


                        <div layout='row'>


                        <md-input-container class="md-block" flex='50'>

                            <label>Size</label>
                            <input type='number' step='any' name='size' ng-model='vm.addOpportunity.size' required />


                        </md-input-container>

                        </div>



                        <div layout="row">

                            <md-input-container flex="50">
                                <label>Qualify</label>
                                <md-select required name="contact" ng-model="vm.addOpportunity.qualify">

                                    <md-option  value='unqualified'>Unqualified</md-option>
                                    <md-option  value='contacted'>Contacted</md-option>
                                    <md-option  value='meeting'>Meeting</md-option>
                                    <md-option  value='negotiating'>Negotiating</md-option>
                                    <md-option  value='closed'>Closed</md-option>
                                                                    
                                    </md-option>
                            </md-input-container>

                            <md-datepicker flex="50" ng-model='vm.addOpportunity.DateCloseUnformatted' md-placeholder = 'Expected close' required>
                            </md-datepicker>
                        </div>

                        <md-input-container class="md-block">
                            <label>Comments</label>
                                <textarea id='textarea' md-maxlength="300" rows="5" ng-model="vm.addOpportunity.comments"  md-select-on-focus ></textarea>
                        </md-input-container>




                        <div layout='row' layout-align='end end'>
                            <md-button type="submit" ng-click='addModalOpportunitySubmit()'>Add opportunity</md-button>
                        </div>
                    

                    </form>
                </md-content>   

                </md-tab>


        <md-tab label="contact">


                <md-content flex layout-padding>

                    <form name="projectForm">


                        <div layout='row'>

                        <md-input-container class="md-block" flex='50' required>
                            <label>First name</label>
                                <input name='fname' ng-model='vm.addContact.fname' type='text'>
                        </md-input-container>


                        <md-input-container class="md-block" flex='50' required>
                            <label>Last name</label>
                                <input name='lname' ng-model='vm.addContact.lname' type='text'>
                        </md-input-container>

                        </div>



                        <div layout="row">

                            <md-input-container flex="50">
                                <label>Email</label>
                                <input name="email" ng-model="vm.addContact.email" type='email'>
                            </md-input-container>


                            <md-input-container class="md-block" flex='50'>

                                <label>Phone number</label>
                                <input name='PhoneNumber' ng-model='vm.addContact.PhoneNumber'  />

                            </md-input-container>

                        </div>




                        <div layout='row' layout-align='end end'>
                            <md-button type="submit" ng-click='addModalContactSubmit()'>Add contact</md-button>
                        </div>
                    

                    </form>
                </md-content>   
            </md-dialog>
        </div>
    </div>




<!-- Below is the editContact modal, hidden until prompted. Ideally this should be in 
    a separate template and file -->
    <div style="visibility: hidden">
      <div class="md-dialog-container" id="editContact" ng-coak>
            <md-dialog flex>

                <md-toolbar>
                  <div class="md-toolbar-tools">
                    <h2>View and edit contact</h2>
                    <span flex></span>
                    <md-button class="md-icon-button" ng-click="cancel()">
                      <md-icon md-svg-src="img/icons/ic_close_24px.svg" aria-label="Close dialog"></md-icon>
                    </md-button>
                  </div>
                </md-toolbar>
      


                <md-content flex layout-padding>

                    <form name="projectForm">


                        <div layout='row'>


                        <md-input-container class="md-block" flex='50'>

                            <label>First name</label>
                            <input type='text' step='any' name='fname' ng-model='vm.editContact.fname' placeholder={%verbatim%}{{contact.fname}}{%endverbatim%} />


                        </md-input-container>


                        <md-input-container class="md-block" flex='50'>

                            <label>Last name</label>
                            <input type='text' step='any' name='lname' ng-model='vm.editContact.lname' placeholder={%verbatim%}{{contact.lname}}{%endverbatim%} />


                        </md-input-container>

                        </div>


                        <div layout='row'>


                        <md-input-container class="md-block" flex='50'>

                            <label>Email</label>
                            <input type='email' step='any' name='email' ng-model='vm.editContact.email' placeholder={%verbatim%}{{contact.email}}{%endverbatim%} />


                        </md-input-container>


                        <md-input-container class="md-block" flex='50'>

                            <label>Phone number</label>
                            <input type='number' step='any' name='PhoneNumber' ng-model='vm.editContact.PhoneNumber' placeholder={%verbatim%}{{contact.PhoneNumber}}{%endverbatim%} />


                        </md-input-container>

                        </div>                        



                        <div layout='row' layout-align='end end'>
                            <md-button type="submit" ng-click='editContactSubmit(contact)'>Edit contact</md-button>
                        </div>
                    

                    </form>
                </md-content>   

             
            </md-dialog>
        </div>
    </div>

